# Power Platform PBMM Security Guardrails
## Canadian Federal Government Compliance Framework

**Document Version:** 1.0  
**Effective Date:** July 2025  
**Authority:** Shared Services Canada (SSC) & Treasury Board Secretariat (TBS)  
**Classification:** Protected B Medium Integrity Medium Availability (PBMM)

---

## Table of Contents

### Main Document

- [Power Platform PBMM Security Guardrails](#power-platform-pbmm-security-guardrails)
  - [Canadian Federal Government Compliance Framework](#canadian-federal-government-compliance-framework)
  - [Table of Contents](#table-of-contents)
    - [Main Document](#main-document)
    - [Annex A: Detailed Configuration Settings](#annex-a-detailed-configuration-settings)
  - [Executive Summary](#executive-summary)
  - [1. Tenant-Level Security Configuration](#1-tenant-level-security-configuration)
    - [1.1 Environment Provisioning Controls (MANDATORY)](#11-environment-provisioning-controls-mandatory)
    - [1.2 Cross-Tenant Inbound/Outbound Restrictions (MANDATORY)](#12-cross-tenant-inboundoutbound-restrictions-mandatory)
    - [1.3 Data Loss Prevention (DLP) Policies (MANDATORY)](#13-data-loss-prevention-dlp-policies-mandatory)
      - [Tenant-Wide DLP Policy](#tenant-wide-dlp-policy)
      - [Environment-Specific DLP Policies](#environment-specific-dlp-policies)
    - [1.4 Maker Portal Settings (MANDATORY)](#14-maker-portal-settings-mandatory)
  - [2. Environment-Level Security Configuration](#2-environment-level-security-configuration)
    - [2.1 Security Groups (MANDATORY)](#21-security-groups-mandatory)
    - [2.2 Environment Security Roles (MANDATORY)](#22-environment-security-roles-mandatory)
    - [2.3 Managed Environments (MANDATORY for Production)](#23-managed-environments-mandatory-for-production)
    - [2.4 Data Residency and Sovereignty (MANDATORY)](#24-data-residency-and-sovereignty-mandatory)
  - [3. Application and Flow Governance](#3-application-and-flow-governance)
    - [3.1 App Registration and Approval Process (MANDATORY)](#31-app-registration-and-approval-process-mandatory)
    - [3.2 Solution Management (MANDATORY)](#32-solution-management-mandatory)
    - [3.3 Connection Management (MANDATORY)](#33-connection-management-mandatory)
  - [4. Data Protection and Privacy](#4-data-protection-and-privacy)
    - [4.1 Data Classification (MANDATORY)](#41-data-classification-mandatory)
    - [4.2 Encryption (MANDATORY)](#42-encryption-mandatory)
    - [4.3 Data Retention and Disposal (MANDATORY)](#43-data-retention-and-disposal-mandatory)
  - [5. Monitoring and Auditing](#5-monitoring-and-auditing)
    - [5.1 Audit Logging (MANDATORY)](#51-audit-logging-mandatory)
    - [5.2 Security Monitoring (MANDATORY)](#52-security-monitoring-mandatory)
    - [5.3 Compliance Reporting (MANDATORY)](#53-compliance-reporting-mandatory)
  - [6. Identity and Access Management](#6-identity-and-access-management)
    - [6.1 Authentication (MANDATORY)](#61-authentication-mandatory)
    - [6.2 Privileged Access Management (MANDATORY)](#62-privileged-access-management-mandatory)
  - [7. Network Security](#7-network-security)
    - [7.1 Network Controls (MANDATORY)](#71-network-controls-mandatory)
  - [8. Business Continuity and Disaster Recovery](#8-business-continuity-and-disaster-recovery)
    - [8.1 Backup and Recovery (MANDATORY)](#81-backup-and-recovery-mandatory)
    - [8.2 Service Continuity (MANDATORY)](#82-service-continuity-mandatory)
  - [9. Vendor Management](#9-vendor-management)
    - [9.1 Third-Party Connector Assessment (MANDATORY)](#91-third-party-connector-assessment-mandatory)
  - [10. Training and Awareness](#10-training-and-awareness)
    - [10.1 User Training (MANDATORY)](#101-user-training-mandatory)
  - [11. Configuration Verification Checklist](#11-configuration-verification-checklist)
    - [11.1 Tenant Level Verification](#111-tenant-level-verification)
    - [11.2 Environment Level Verification](#112-environment-level-verification)
    - [11.3 Application Level Verification](#113-application-level-verification)
  - [12. Compliance Matrix](#12-compliance-matrix)
  - [Implementation Timeline](#implementation-timeline)
    - [Phase 1 (0-30 days): Foundation](#phase-1-0-30-days-foundation)
    - [Phase 2 (30-60 days): Environment Security](#phase-2-30-60-days-environment-security)
    - [Phase 3 (60-90 days): Advanced Controls](#phase-3-60-90-days-advanced-controls)
    - [Phase 4 (90+ days): Continuous Improvement](#phase-4-90-days-continuous-improvement)
  - [Maintenance and Updates](#maintenance-and-updates)
    - [Regular Tasks](#regular-tasks)
    - [Change Management](#change-management)
  - [Contact Information](#contact-information)
- [Annex A: Detailed Configuration Settings](#annex-a-detailed-configuration-settings-1)
  - [Power Platform PBMM Guardrails - Canadian Federal Government](#power-platform-pbmm-guardrails---canadian-federal-government)
  - [A.1 Power Platform Tenant Settings Configuration](#a1-power-platform-tenant-settings-configuration)
    - [A.1.1 Core Tenant Security Settings](#a11-core-tenant-security-settings)
    - [A.1.2 Search and Discovery Settings](#a12-search-and-discovery-settings)
    - [A.1.3 Power Apps Specific Settings](#a13-power-apps-specific-settings)
    - [A.1.4 Teams Integration Settings](#a14-teams-integration-settings)
    - [A.1.5 Copilot and AI Settings](#a15-copilot-and-ai-settings)
    - [A.1.6 Environment Routing and Management](#a16-environment-routing-and-management)
  - [A.2 Environment Groups Configuration](#a2-environment-groups-configuration)
    - [A.2.1 Creating Environment Groups](#a21-creating-environment-groups)
    - [A.2.2 Environment Group Rules Configuration](#a22-environment-group-rules-configuration)
  - [A.3 Microsoft 365 Integration Security Settings](#a3-microsoft-365-integration-security-settings)
    - [A.3.1 SharePoint Integration](#a31-sharepoint-integration)
    - [A.3.2 OneDrive for Business Integration](#a32-onedrive-for-business-integration)
    - [A.3.3 Microsoft Teams Integration](#a33-microsoft-teams-integration)
    - [A.3.4 Microsoft Copilot Integration Controls](#a34-microsoft-copilot-integration-controls)
  - [A.4 Power Pages Security Configuration](#a4-power-pages-security-configuration)
    - [A.4.1 Power Pages Tenant Settings](#a41-power-pages-tenant-settings)
    - [A.4.2 Power Pages Site-Level Security Settings](#a42-power-pages-site-level-security-settings)
      - [A.4.2.1 Authentication Configuration](#a421-authentication-configuration)
      - [A.4.2.2 Authorization and Access Control](#a422-authorization-and-access-control)
      - [A.4.2.3 Network Security Settings](#a423-network-security-settings)
      - [A.4.2.4 Content Security Policy (CSP)](#a424-content-security-policy-csp)
      - [A.4.2.5 HTTPS and Transport Security](#a425-https-and-transport-security)
      - [A.4.2.6 Data Protection Settings](#a426-data-protection-settings)
      - [A.4.2.7 Monitoring and Auditing](#a427-monitoring-and-auditing)
  - [A.5 Data Loss Prevention (DLP) Policy Templates](#a5-data-loss-prevention-dlp-policy-templates)
    - [A.5.1 Tenant-Wide PBMM DLP Policy](#a51-tenant-wide-pbmm-dlp-policy)
    - [A.5.2 Production Environment DLP Policy](#a52-production-environment-dlp-policy)
    - [A.5.3 Connector Action-Level Controls](#a53-connector-action-level-controls)
  - [A.6 Monitoring and Compliance Verification](#a6-monitoring-and-compliance-verification)
    - [A.6.1 Automated Compliance Checking](#a61-automated-compliance-checking)
    - [A.6.2 Regular Assessment Schedule](#a62-regular-assessment-schedule)
  - [A.7 Integration Testing and Validation](#a7-integration-testing-and-validation)
    - [A.7.1 SharePoint Integration Testing](#a71-sharepoint-integration-testing)
    - [A.7.2 Teams Integration Testing](#a72-teams-integration-testing)
    - [A.7.3 Power Pages Security Testing](#a73-power-pages-security-testing)
  - [A.8 Implementation Checklist](#a8-implementation-checklist)
    - [A.8.1 Pre-Implementation Requirements](#a81-pre-implementation-requirements)
    - [A.8.2 Phase 1: Core Tenant Configuration (Days 1-7)](#a82-phase-1-core-tenant-configuration-days-1-7)
    - [A.8.3 Phase 2: Environment Groups and DLP (Days 8-14)](#a83-phase-2-environment-groups-and-dlp-days-8-14)
    - [A.8.4 Phase 3: Integration Security (Days 15-21)](#a84-phase-3-integration-security-days-15-21)
    - [A.8.5 Phase 4: Power Pages Security (Days 22-30)](#a85-phase-4-power-pages-security-days-22-30)
    - [A.8.6 Phase 5: Monitoring and Compliance (Days 31-60)](#a86-phase-5-monitoring-and-compliance-days-31-60)
  - [A.9 Troubleshooting Guide](#a9-troubleshooting-guide)
    - [A.9.1 Common Configuration Issues](#a91-common-configuration-issues)
    - [A.9.2 Rollback Procedures](#a92-rollback-procedures)
  - [Document Control](#document-control)

### Annex A: Detailed Configuration Settings
A.1 [Power Platform Tenant Settings Configuration](#a1-power-platform-tenant-settings-configuration)

  - A.1.1 [Core Tenant Security Settings](#a11-core-tenant-security-settings)
  - A.1.2 [Search and Discovery Settings](#a12-search-and-discovery-settings)
  - A.1.3 [Power Apps Specific Settings](#a13-power-apps-specific-settings)
  - A.1.4 [Teams Integration Settings](#a14-teams-integration-settings)
  - A.1.5 [Copilot and AI Settings](#a15-copilot-and-ai-settings)
  - A.1.6 [Environment Routing and Management](#a16-environment-routing-and-management)

A.2 [Environment Groups Configuration](#a2-environment-groups-configuration)

  - A.2.1 [Creating Environment Groups](#a21-creating-environment-groups)
  - A.2.2 [Environment Group Rules Configuration](#a22-environment-group-rules-configuration)

A.3 [Microsoft 365 Integration Security Settings](#a3-microsoft-365-integration-security-settings)

  - A.3.1 [SharePoint Integration](#a31-sharepoint-integration)
  - A.3.2 [OneDrive for Business Integration](#a32-onedrive-for-business-integration)
  - A.3.3 [Microsoft Teams Integration](#a33-microsoft-teams-integration)
  - A.3.4 [Microsoft Copilot Integration Controls](#a34-microsoft-copilot-integration-controls)

A.4 [Power Pages Security Configuration](#a4-power-pages-security-configuration)

  - A.4.1 [Power Pages Tenant Settings](#a41-power-pages-tenant-settings)
  - A.4.2 [Power Pages Site-Level Security Settings](#a42-power-pages-site-level-security-settings)

A.5 [Data Loss Prevention (DLP) Policy Templates](#a5-data-loss-prevention-dlp-policy-templates)

  - A.5.1 [Tenant-Wide PBMM DLP Policy](#a51-tenant-wide-pbmm-dlp-policy)
  - A.5.2 [Production Environment DLP Policy](#a52-production-environment-dlp-policy)
  - A.5.3 [Connector Action-Level Controls](#a53-connector-action-level-controls)

A.6 [Monitoring and Compliance Verification](#a6-monitoring-and-compliance-verification)

  - A.6.1 [Automated Compliance Checking](#a61-automated-compliance-checking)
  - A.6.2 [Regular Assessment Schedule](#a62-regular-assessment-schedule)

A.7 [Integration Testing and Validation](#a7-integration-testing-and-validation)

  - A.7.1 [SharePoint Integration Testing](#a71-sharepoint-integration-testing)
  - A.7.2 [Teams Integration Testing](#a72-teams-integration-testing)
  - A.7.3 [Power Pages Security Testing](#a73-power-pages-security-testing)

A.8 [Implementation Checklist](#a8-implementation-checklist)

  - A.8.1 [Pre-Implementation Requirements](#a81-pre-implementation-requirements)
  - A.8.2 [Phase 1: Core Tenant Configuration](#a82-phase-1-core-tenant-configuration-days-1-7)
  - A.8.3 [Phase 2: Environment Groups and DLP](#a83-phase-2-environment-groups-and-dlp-days-8-14)
  - A.8.4 [Phase 3: Integration Security](#a84-phase-3-integration-security-days-15-21)
  - A.8.5 [Phase 4: Power Pages Security](#a85-phase-4-power-pages-security-days-22-30)
  - A.8.6 [Phase 5: Monitoring and Compliance](#a86-phase-5-monitoring-and-compliance-days-31-60)

A.9 [Troubleshooting Guide](#a9-troubleshooting-guide)

  - A.9.1 [Common Configuration Issues](#a91-common-configuration-issues)
  - A.9.2 [Rollback Procedures](#a92-rollback-procedures)

---

## Executive Summary

This document provides comprehensive security guardrails for Microsoft Power Platform deployment within Canadian Federal Government departments and agencies to meet Protected B, Medium Integrity, Medium Availability (PBMM) requirements as defined by the Canadian Centre for Cyber Security (CCCS) and aligned with ITSG-33 standards.

These guardrails are designed to ensure compliance with:

- CCCS Medium Cloud Profile Recommendations
- Government of Canada Security Control Profile for Cloud-based GC Services
- ITSG-33 Annex 4A - Profile 1 (PBMM)
- Privacy Act and Access to Information Act requirements

---

## 1. Tenant-Level Security Configuration

### 1.1 Environment Provisioning Controls (MANDATORY)

**Requirement:** Restrict environment creation to authorized administrators only.

**Configuration:**

- **Production Environments:** Only specific admins
- **Trial Environments:** Only specific admins  
- **Developer Environments:** Only specific admins

**Authorized Roles:**

- Global Administrator
- Power Platform Administrator
- Dynamics 365 Administrator

**Rationale:** Prevents environment sprawl and ensures proper data sovereignty controls.

**Verification:** Navigate to Power Platform Admin Center > Settings > Tenant Settings > Environment Provisioning

### 1.2 Cross-Tenant Inbound/Outbound Restrictions (MANDATORY)

**Requirement:** Block all cross-tenant data sharing and external tenant access.

**Configuration:**

- Disable cross-tenant inbound connections
- Disable cross-tenant outbound connections
- Block external user sharing
- Restrict guest user access

**Implementation:** Power Platform Admin Center > Settings > Tenant Settings > Cross-tenant access

### 1.3 Data Loss Prevention (DLP) Policies (MANDATORY)

**Requirement:** Implement comprehensive DLP policies at both tenant and environment levels.

#### Tenant-Wide DLP Policy
**Scope:** All environments
**Purpose:** Block high-risk connectors organization-wide

**Blocked Connectors (Minimum):**

- Social media platforms (Twitter, Facebook, Instagram, LinkedIn)
- Public file sharing (Dropbox, Google Drive personal, Box personal)
- Personal cloud storage services
- Anonymous survey tools
- Public forums and wikis
- Cryptocurrency services
- Gaming platforms
- Dating applications

**Business Category Connectors:**

- Microsoft 365 (SharePoint, Teams, Outlook, OneDrive for Business)
- Microsoft Dataverse
- Azure services (SQL Database, Key Vault, etc.)
- Approved government systems

**Non-Business Category:**

- Internal tools and approved third-party services
- Testing and development connectors

#### Environment-Specific DLP Policies
**Production Environments:**

- More restrictive than tenant policy
- Only pre-approved business connectors
- Audit all connector usage
- Enable connector action-level controls

**Development/Test Environments:**

- Slightly less restrictive for testing
- Still block high-risk public connectors
- Enable additional logging

### 1.4 Maker Portal Settings (MANDATORY)

**Configuration:**

- Disable maker welcome content
- Disable community content sharing
- Restrict template gallery access
- Disable sample app installation
- Enable admin notification for new apps

---

## 2. Environment-Level Security Configuration

### 2.1 Security Groups (MANDATORY)

**Requirement:** All environments must be associated with Microsoft Entra security groups.

**Implementation:**

- Create dedicated security groups for each environment
- Implement least privilege access
- Regular access reviews (quarterly minimum)
- No direct user assignments - only through security groups

**Naming Convention:**

- `GC-PowerPlatform-[Department]-[Environment]-[Role]`
- Example: `GC-PowerPlatform-ISED-Prod-Makers`

### 2.2 Environment Security Roles (MANDATORY)

**Standard Role Assignments:**

- **System Administrator:** IT security personnel only (maximum 2-3 users)
- **Environment Admin:** Designated environment managers
- **Environment Maker:** Authorized citizen developers
- **Basic User:** Read-only access for business users

**Custom Security Roles:** Create department-specific roles with minimal required permissions

### 2.3 Managed Environments (MANDATORY for Production)

**Requirements:**

- Enable all production environments as Managed Environments
- Configure sharing limits and restrictions
- Enable data classification
- Implement solution checker enforcement
- Enable maker impact analysis

### 2.4 Data Residency and Sovereignty (MANDATORY)

**Requirements:**

- All environments must be created in Canada Central or Canada East regions
- Enable data residency compliance
- Configure geographic data storage restrictions
- Implement cross-border data transfer controls

---

## 3. Application and Flow Governance

### 3.1 App Registration and Approval Process (MANDATORY)

**Requirements:**

- All production apps require formal approval
- Security review for apps handling Protected B data
- Code review and testing requirements
- Documentation and change management

**Process:**

1. Development in designated dev environment
2. Security assessment using solution checker
3. Privacy impact assessment (if required)
4. Business approval and sign-off
5. Deployment to production with monitoring

### 3.2 Solution Management (MANDATORY)

**Requirements:**

- All production deployments via managed solutions
- Version control and change tracking
- Rollback procedures documented
- Solution layering restrictions

### 3.3 Connection Management (MANDATORY)

**Requirements:**

- Service account connections for production flows
- No personal account connections in production
- Connection approval workflow
- Regular connection audits

---

## 4. Data Protection and Privacy

### 4.1 Data Classification (MANDATORY)

**Requirements:**

- Implement Microsoft Purview data classification
- Label all Protected B data appropriately
- Configure automatic labeling policies
- Monitor data access and usage

### 4.2 Encryption (MANDATORY)

**Requirements:**

- Data encrypted at rest and in transit
- Customer-managed encryption keys where applicable
- Key rotation policies implemented
- Encryption compliance monitoring

### 4.3 Data Retention and Disposal (MANDATORY)

**Requirements:**

- Configure retention policies per government standards
- Implement secure deletion procedures
- Document data lifecycle management
- Legal hold capabilities

---

## 5. Monitoring and Auditing

### 5.1 Audit Logging (MANDATORY)

**Requirements:**

- Enable comprehensive audit logging
- Log retention: minimum 7 years for Protected B data
- Real-time monitoring for security events
- Integration with SIEM solutions

**Key Events to Monitor:**

- User access and authentication
- Data access and modifications
- Administrative actions
- App and flow executions
- DLP policy violations
- Environment changes

### 5.2 Security Monitoring (MANDATORY)

**Requirements:**

- 24/7 monitoring of security events
- Incident response procedures
- Threat detection and analysis
- Regular security assessments

### 5.3 Compliance Reporting (MANDATORY)

**Requirements:**

- Monthly compliance dashboards
- Quarterly security reviews
- Annual risk assessments
- Continuous compliance monitoring

---

## 6. Identity and Access Management

### 6.1 Authentication (MANDATORY)

**Requirements:**

- Multi-factor authentication (MFA) for all users
- Conditional access policies
- Device compliance requirements
- Session management controls

### 6.2 Privileged Access Management (MANDATORY)

**Requirements:**

- Just-in-time access for administrators
- Privileged identity management (PIM)
- Administrative account separation
- Regular privilege reviews

---

## 7. Network Security

### 7.1 Network Controls (MANDATORY)

**Requirements:**

- IP address restrictions where applicable
- VPN requirements for external access
- Network segmentation
- Firewall rules and monitoring

---

## 8. Business Continuity and Disaster Recovery

### 8.1 Backup and Recovery (MANDATORY)

**Requirements:**

- Regular environment backups
- Documented recovery procedures
- Recovery time/point objectives defined
- Cross-region backup strategy

### 8.2 Service Continuity (MANDATORY)

**Requirements:**

- Service availability monitoring
- Incident response plans
- Communication procedures
- Alternative processing arrangements

---

## 9. Vendor Management

### 9.1 Third-Party Connector Assessment (MANDATORY)

**Requirements:**

- Security assessment of all third-party connectors
- Vendor risk assessment
- Contract security requirements
- Regular vendor reviews

---

## 10. Training and Awareness

### 10.1 User Training (MANDATORY)

**Requirements:**

- Security awareness training for all users
- Role-specific training programs
- Annual training updates
- Phishing simulation exercises

---

## 11. Configuration Verification Checklist

### 11.1 Tenant Level Verification

- [ ] Environment provisioning restricted to admins
- [ ] Cross-tenant access disabled
- [ ] Tenant-wide DLP policy implemented
- [ ] Maker portal restrictions configured
- [ ] Self-service purchasing disabled
- [ ] Analytics data sharing reviewed

### 11.2 Environment Level Verification

- [ ] Security groups assigned
- [ ] Managed environment enabled (production)
- [ ] Environment-specific DLP policies
- [ ] Data residency compliance
- [ ] Audit logging enabled
- [ ] Security roles properly assigned

### 11.3 Application Level Verification

- [ ] Solution checker compliance
- [ ] Security review completed
- [ ] Connection security verified
- [ ] Data classification applied
- [ ] Monitoring configured

---

## 12. Compliance Matrix

| ITSG-33 Control | Power Platform Setting | Implementation Status | Verification Method |
|-----------------|------------------------|---------------------|-------------------|
| AC-1 | Security roles and groups | Mandatory | PowerShell audit |
| AC-2 | User provisioning | Mandatory | Admin center review |
| AC-3 | Access enforcement | Mandatory | DLP policy check |
| AC-6 | Least privilege | Mandatory | Role assignment audit |
| AU-1 | Audit policy | Mandatory | Logging verification |
| AU-2 | Audit events | Mandatory | Event configuration |
| CA-1 | Security assessment | Mandatory | Regular reviews |
| CM-1 | Configuration management | Mandatory | Solution tracking |
| CP-1 | Contingency planning | Mandatory | Backup verification |
| IA-1 | Identification/Authentication | Mandatory | MFA enforcement |
| SC-1 | System communications | Mandatory | Encryption check |
| SI-1 | System integrity | Mandatory | Solution checker |

---

## Implementation Timeline

### Phase 1 (0-30 days): Foundation

- Configure tenant-level security settings
- Implement basic DLP policies
- Set up security groups
- Enable audit logging

### Phase 2 (30-60 days): Environment Security

- Configure environment-specific settings
- Implement managed environments
- Deploy monitoring solutions
- User training initiation

### Phase 3 (60-90 days): Advanced Controls

- Advanced DLP policies
- Integration with SIEM
- Compliance reporting
- Full operational procedures

### Phase 4 (90+ days): Continuous Improvement

- Regular reviews and updates
- Advanced analytics
- Threat hunting
- Optimization

---

## Maintenance and Updates

### Regular Tasks

- **Weekly:** Review security alerts and incidents
- **Monthly:** Audit user access and permissions
- **Quarterly:** Review and update DLP policies
- **Annually:** Comprehensive security assessment

### Change Management

- All configuration changes require approval
- Testing in non-production environments
- Rollback procedures documented
- Change tracking and documentation

---

## Contact Information

**Primary Contact:** IT Security Officer
**Secondary Contact:** Power Platform Administrator
**Escalation:** Chief Information Security Officer (CISO)

**Emergency Contact Procedures:**

1. Immediate: IT Security Help Desk
2. Within 1 hour: CISO notification
3. Within 4 hours: Deputy Minister notification (if required)

---

# Annex A: Detailed Configuration Settings
## Power Platform PBMM Guardrails - Canadian Federal Government

**Document Version:** 1.0  
**Effective Date:** July 2025  
**Authority:** Shared Services Canada (SSC) & Treasury Board Secretariat (TBS)  
**Classification:** Protected B Medium Integrity Medium Availability (PBMM)

---

## A.1 Power Platform Tenant Settings Configuration

The following section provides specific configuration parameters for Power Platform tenant settings to achieve PBMM compliance.

### A.1.1 Core Tenant Security Settings

Navigate to: **Power Platform Admin Center > Settings > Tenant Settings**

| Setting | Configuration | Value | Rationale |
|---------|--------------|-------|-----------|
| `walkMeOptOut` | Disable WalkMe guided tours | `true` | Prevent external guidance system access |
| `disableEnvironmentCreationByNonAdminUsers` | Restrict environment creation | `true` | Control environment sprawl and ensure proper governance |
| `disableTrialEnvironmentCreationByNonAdminUsers` | Restrict trial environment creation | `true` | Prevent unauthorized trial environments |
| `disableDeveloperEnvironmentCreationByNonAdminUsers` | Restrict developer environment creation | `true` | Control development environment access |
| `disablePortalsCreationByNonAdminUsers` | Restrict Power Pages creation | `true` | Ensure proper oversight of external-facing sites |
| `disableCapacityAllocationByEnvironmentAdmins` | Centralize capacity management | `true` | Maintain centralized control over resources |
| `disableSupportTicketsVisibleByAllUsers` | Restrict support ticket visibility | `true` | Limit access to support information |
| `disableNewsletterSendout` | Disable newsletters | `true` | Reduce information exposure |
| `disableNPSCommentsReachout` | Disable NPS surveys | `true` | Prevent data collection by Microsoft |
| `disableSurveyFeedback` | Disable feedback surveys | `true` | Prevent data sharing |

### A.1.2 Search and Discovery Settings

| Setting | Configuration | Value | Rationale |
|---------|--------------|-------|-----------|
| `powerPlatform.search.disableDocsSearch` | Disable documentation search | `true` | Prevent external documentation access |
| `powerPlatform.search.disableCommunitySearch` | Disable community search | `true` | Prevent external community access |
| `powerPlatform.search.disableBingVideoSearch` | Disable video search | `true` | Prevent external video content access |

### A.1.3 Power Apps Specific Settings

| Setting | Configuration | Value | Rationale |
|---------|--------------|-------|-----------|
| `powerPlatform.powerApps.disableShareWithEveryone` | Disable "Share with Everyone" | `true` | Prevent broad sharing capabilities |
| `powerPlatform.powerApps.enableGuestsToMake` | Disable guest app creation | `false` | Prevent external users from creating apps |
| `powerPlatform.powerApps.disableMembersIndicator` | Hide members indicator | `true` | Reduce information disclosure |
| `powerPlatform.powerApps.disableMakerMatch` | Disable maker match feature | `true` | Prevent internal resource discovery |
| `powerPlatform.powerApps.disableCreateFromImage` | Disable AI image app creation | `true` | Prevent AI-powered app generation |
| `powerPlatform.powerApps.disableCreateFromFigma` | Disable Figma integration | `true` | Prevent external design tool integration |

### A.1.4 Teams Integration Settings

| Setting | Configuration | Value | Rationale |
|---------|--------------|-------|-----------|
| `powerPlatform.teamsIntegration.shareWithColleaguesUserLimit` | Limit sharing scope | `100` | Restrict sharing to smaller groups |

### A.1.5 Copilot and AI Settings

| Setting | Configuration | Value | Rationale |
|---------|--------------|-------|-----------|
| `powerPlatform.powerAutomate.disableCopilot` | Disable Power Automate Copilot | `true` | Prevent AI assistance in flow creation |
| `powerPlatform.modelExperimentation.enableModelDataSharing` | Disable model data sharing | `false` | Prevent data sharing for AI training |
| `powerPlatform.modelExperimentation.disableDataLogging` | Enable data logging restrictions | `true` | Prevent data logging for model improvement |

### A.1.6 Environment Routing and Management

| Setting | Configuration | Value | Rationale |
|---------|--------------|-------|-----------|
| `enableDefaultEnvironmentRouting` | Enable controlled routing | `true` | Direct new makers to managed environments |
| `environmentRoutingAllMakers` | Restrict to new makers only | `false` | Limit routing to reduce default environment usage |
| `environmentRoutingTargetEnvironmentGroupId` | Set target environment group | `[specific-group-id]` | Route to controlled environment group |
| `environmentRoutingTargetSecurityGroupId` | Restrict by security group | `[security-group-id]` | Limit routing to authorized users |

## A.2 Environment Groups Configuration

### A.2.1 Creating Environment Groups

**Purpose:** Organize environments into logical groups for consistent policy application.

**Recommended Environment Groups:**

1. **Production Group**
   - **Name:** `GC-Production-Environments`
   - **Description:** Production environments for live business applications
   - **Managed Environment:** Required
   - **Security Level:** Highest

2. **Development Group**
   - **Name:** `GC-Development-Environments` 
   - **Description:** Development and testing environments
   - **Managed Environment:** Required
   - **Security Level:** Medium

3. **Personal Productivity Group**
   - **Name:** `GC-Personal-Productivity`
   - **Description:** Personal developer environments
   - **Managed Environment:** Required
   - **Security Level:** Medium

### A.2.2 Environment Group Rules Configuration

**Production Group Rules:**

| Rule | Setting | Value | Purpose |
|------|---------|-------|---------|
| Limit sharing | Enabled | Max 10 users per app | Restrict production app sharing |
| Solution checker | Enforce critical issues | Block deployment | Ensure quality standards |
| Maker welcome content | Custom message | Display governance policy | Inform users of restrictions |
| Weekly digest | Enabled | Admin notification | Monitor usage and issues |
| Data policies | Strict DLP | Business connectors only | Enforce data protection |
| IP firewall | Enabled | Corporate IP ranges only | Restrict access by location |

**Development Group Rules:**

| Rule | Setting | Value | Purpose |
|------|---------|-------|---------|
| Limit sharing | Enabled | Max 25 users per app | Allow broader testing |
| Solution checker | Warn on issues | Allow with warnings | Enable development flexibility |
| Maker welcome content | Development guidelines | Display best practices | Guide developers |
| Weekly digest | Enabled | Environment owner notification | Monitor development activity |
| Data policies | Development DLP | Allow additional test connectors | Enable testing scenarios |

## A.3 Microsoft 365 Integration Security Settings

### A.3.1 SharePoint Integration

**Configuration Location:** Power Platform Admin Center > Environments > [Environment] > Settings > Integration

| Setting | Configuration | Value | Security Rationale |
|---------|--------------|-------|-------------------|
| SharePoint Integration | Enable with restrictions | Corporate sites only | Limit to approved content sources |
| External Sharing | Disabled | `false` | Prevent external data exposure |
| Guest Access | Disabled | `false` | Block external user access |
| Site Collection Access | Restricted | Admin-approved sites only | Control data source access |
| Document Library Permissions | Inherit from SharePoint | Default | Maintain consistent permissions |

**SharePoint DLP Configuration:**

- Block social media connectors when combined with SharePoint
- Require admin approval for new SharePoint connections
- Enable audit logging for all SharePoint interactions
- Implement retention policies for SharePoint data accessed via Power Platform

### A.3.2 OneDrive for Business Integration

| Setting | Configuration | Value | Security Rationale |
|---------|--------------|-------|-------------------|
| OneDrive Access | Corporate accounts only | Business OneDrive only | Prevent personal OneDrive access |
| File Sharing | Restricted | Organization only | Prevent external file sharing |
| Sync Restrictions | Enabled | Corporate devices only | Control device access |
| External Sharing | Disabled | `false` | Block external sharing |

### A.3.3 Microsoft Teams Integration

| Setting | Configuration | Value | Security Rationale |
|---------|--------------|-------|-------------------|
| Teams App Installation | Admin approval required | `true` | Control app deployment |
| External Teams Access | Disabled | `false` | Prevent external tenant access |
| Guest Access | Disabled | `false` | Block external users |
| App Sharing Limit | Restricted | 50 users maximum | Limit sharing scope |
| Data Residency | Canada only | Canadian data centers | Ensure data sovereignty |

**Teams-Specific Power Apps Settings:**

```json
{
  "teamsIntegration": {
    "shareWithColleaguesUserLimit": 50,
    "allowGuestAccess": false,
    "requireAdminApproval": true,
    "enableExternalSharing": false
  }
}
```

### A.3.4 Microsoft Copilot Integration Controls

**Tenant-Level Copilot Settings:**

| Setting | Configuration | Value | Security Rationale |
|---------|--------------|-------|-------------------|
| Copilot in Power Platform | Controlled deployment | Admin-enabled only | Prevent unauthorized AI usage |
| Data Sharing for Training | Disabled | `false` | Prevent data use for model training |
| External Data Sources | Blocked | `false` | Prevent external data access |
| Copilot Analytics | Government cloud only | Canada region | Ensure data residency |

**Power Apps Copilot Settings:**

```json
{
  "copilotSettings": {
    "enableCopilotInPowerApps": false,
    "enableDataSharingForTraining": false,
    "enableExternalDataSources": false,
    "requireAdminApproval": true,
    "enableAuditLogging": true
  }
}
```

**Power Automate Copilot Settings:**

```json
{
  "powerAutomate": {
    "disableCopilot": true,
    "disableAIBuilder": false,
    "requireAdminApprovalForAI": true
  }
}
```

## A.4 Power Pages Security Configuration

### A.4.1 Power Pages Tenant Settings

**Configuration Location:** Power Platform Admin Center > Settings > Tenant Settings > Power Pages

| Setting | Configuration | Value | PBMM Requirement |
|---------|--------------|-------|------------------|
| `disablePortalsCreationByNonAdminUsers` | Restrict creation | `true` | MANDATORY - Prevent unauthorized external sites |
| External Authentication Only | Enforce | `true` | MANDATORY - Require identity verification |
| Anonymous Access | Disabled by default | `false` | MANDATORY - Require authentication |
| Site Visibility | Internal only by default | Private | MANDATORY - Prevent accidental exposure |

### A.4.2 Power Pages Site-Level Security Settings

#### A.4.2.1 Authentication Configuration

**MANDATORY Settings:**

| Setting | Configuration | Value | Implementation |
|---------|--------------|-------|----------------|
| Authentication Provider | Azure AD B2C or Entra ID | Azure AD B2C (preferred) | Configure OIDC with MFA |
| Multi-Factor Authentication | Required | `true` | Enable in identity provider |
| Session Timeout | Short duration | 30 minutes | Automatic logout |
| Password Policy | Strong requirements | Complex passwords + expiration | Enforce in identity provider |
| Account Lockout | Enabled | 5 failed attempts | Prevent brute force |

**Azure AD B2C Configuration for Power Pages:**

```json
{
  "authenticationSettings": {
    "provider": "AzureADB2C",
    "requireMFA": true,
    "sessionTimeoutMinutes": 30,
    "requirePasswordComplexity": true,
    "maxFailedAttempts": 5,
    "accountLockoutDurationMinutes": 30
  }
}
```

#### A.4.2.2 Authorization and Access Control

**Web Roles Configuration:**

| Role | Permissions | Data Access | Use Case |
|------|-------------|-------------|----------|
| Anonymous Users | None | Public content only | Landing pages only |
| Authenticated Users | Basic read | Limited records | General access |
| Department Users | Department data | Scoped to business unit | Department-specific access |
| Administrators | Full access | All records | Site management |

**Table Permissions (MANDATORY):**

| Table | Create | Read | Write | Delete | Append | Scope |
|-------|--------|------|-------|--------|--------|-------|
| Contact | No | Own records only | Own records only | No | No | Contact |
| Case | Yes | Own records only | Own records only | No | Yes | Contact |
| Knowledge Article | No | Published only | No | No | No | Global |
| Protected Data | No | No | No | No | No | None |

#### A.4.2.3 Network Security Settings

**IP Restrictions (RECOMMENDED for sensitive sites):**

```json
{
  "ipRestrictions": {
    "enabled": true,
    "allowedIpRanges": [
      "192.168.1.0/24",  // Corporate network
      "10.0.0.0/16",     // VPN range
      "173.252.0.0/16"   // Government network range
    ],
    "blockByDefault": true,
    "enableGeoBlocking": true,
    "allowedCountries": ["CA"]
  }
}
```

#### A.4.2.4 Content Security Policy (CSP)

**Mandatory CSP Headers:**

```javascript
// Site Setting: HTTP/Content-Security-Policy
"default-src 'self'; 
 script-src 'self' 'unsafe-inline' 'unsafe-eval' *.powerplatform.microsoft.com; 
 style-src 'self' 'unsafe-inline' *.powerplatform.microsoft.com; 
 img-src 'self' data: *.powerplatform.microsoft.com; 
 connect-src 'self' *.powerplatform.microsoft.com; 
 frame-ancestors 'self'; 
 form-action 'self';"
```

#### A.4.2.5 HTTPS and Transport Security

**Mandatory Transport Settings:**

| Setting | Configuration | Value | Implementation |
|---------|--------------|-------|----------------|
| Force HTTPS | Enabled | `true` | Redirect all HTTP to HTTPS |
| HSTS | Enabled | `max-age=31536000` | Force HTTPS for 1 year |
| TLS Version | Modern only | TLS 1.2+ | Disable older protocols |
| Cipher Suites | Strong only | AES-256, ChaCha20 | Disable weak ciphers |

#### A.4.2.6 Data Protection Settings

**Site Settings for Data Protection:**

| Setting Name | Value | Purpose |
|--------------|-------|---------|
| `Site/EnableAntiForgeryToken` | `true` | CSRF protection |
| `Authentication/RequireSSL` | `true` | Force HTTPS |
| `Site/EnableCustomErrors` | `true` | Hide error details |
| `Search/IndexPageData` | `false` | Prevent search indexing |
| `Site/DisableCookieAuthentication` | `false` | Enable secure cookies |

#### A.4.2.7 Monitoring and Auditing

**Required Audit Settings:**

| Event Type | Logging Level | Retention | Purpose |
|------------|---------------|-----------|---------|
| Authentication | All events | 7 years | Track access attempts |
| Data Access | All operations | 7 years | Monitor data usage |
| Administrative | All changes | 7 years | Track configuration changes |
| Security Events | All violations | 7 years | Incident investigation |
| Performance | Errors only | 1 year | Troubleshooting |

## A.5 Data Loss Prevention (DLP) Policy Templates

### A.5.1 Tenant-Wide PBMM DLP Policy

**Policy Name:** `GC-PBMM-Tenant-Baseline`
**Scope:** All environments
**Purpose:** Block high-risk connectors organization-wide

**Blocked Connectors (MANDATORY):**

```json
{
  "blockedConnectors": [
    "shared_twitter",
    "shared_facebook", 
    "shared_instagram",
    "shared_linkedin",
    "shared_dropbox",
    "shared_googledrive",
    "shared_box",
    "shared_onedrivepersonal",
    "shared_gmail",
    "shared_outlookpersonal",
    "shared_surveymonkey",
    "shared_typeform",
    "shared_salesforce",
    "shared_dynamics365",
    "shared_amazons3",
    "shared_azureblobstorage"
  ]
}
```

**Business Data Group (Approved for government use):**

```json
{
  "businessConnectors": [
    "shared_office365",
    "shared_sharepoint",
    "shared_onedriveforbusiness", 
    "shared_teams",
    "shared_outlook",
    "shared_dataverse",
    "shared_azuresql",
    "shared_azurekeyvault",
    "shared_powerappsnotification"
  ]
}
```

**Non-Business Data Group (Internal tools):**

```json
{
  "nonBusinessConnectors": [
    "shared_excel",
    "shared_word",
    "shared_powerpoint",
    "shared_onenote",
    "shared_planner",
    "shared_approvals",
    "shared_microsoftforms"
  ]
}
```

### A.5.2 Production Environment DLP Policy

**Policy Name:** `GC-PBMM-Production-Strict`
**Scope:** Production environment group
**Purpose:** Strict controls for production workloads

**Additional Restrictions:**

- Custom connector approval required
- Premium connector usage audited
- Cross-environment data flow blocked
- Third-party service integration prohibited

### A.5.3 Connector Action-Level Controls

**SharePoint Connector Restrictions:**

```json
{
  "connectorActions": {
    "shared_sharepoint": {
      "allowedActions": [
        "GetFileContent",
        "GetFileMetadata",
        "ListRootFolder",
        "ListFolder"
      ],
      "blockedActions": [
        "DeleteFile",
        "CreateFile",
        "UpdateFile",
        "ShareFile"
      ]
    }
  }
}
```

## A.6 Monitoring and Compliance Verification

### A.6.1 Automated Compliance Checking

**PowerShell Verification Commands:**

```powershell
# Verify tenant settings compliance
$tenantSettings = Get-TenantSettings
$complianceChecks = @{
    "EnvironmentCreationRestricted" = $tenantSettings.disableEnvironmentCreationByNonAdminUsers
    "TrialCreationRestricted" = $tenantSettings.disableTrialEnvironmentCreationByNonAdminUsers
    "ShareWithEveryoneDisabled" = $tenantSettings.powerPlatform.powerApps.disableShareWithEveryone
    "GuestCreationDisabled" = !$tenantSettings.powerPlatform.powerApps.enableGuestsToMake
}

# Verify DLP policies
$dlpPolicies = Get-AdminDlpPolicy
$tenantWidePolicyExists = $dlpPolicies | Where-Object { $_.environments.count -eq 0 }

# Verify environment security groups
$environments = Get-AdminPowerAppEnvironment
foreach ($env in $environments) {
    $hasSecurityGroup = ![string]::IsNullOrEmpty($env.SecurityGroupId)
    Write-Output "Environment: $($env.DisplayName) - Security Group: $hasSecurityGroup"
}
```

### A.6.2 Regular Assessment Schedule

**Weekly Tasks:**

- Review security alerts and incidents
- Check for new connectors requiring classification
- Monitor environment usage and access

**Monthly Tasks:**

- Audit user access and permissions
- Review DLP policy violations
- Update security group memberships
- Assess compliance metrics

**Quarterly Tasks:**

- Full security assessment
- Review and update DLP policies
- Environment security review
- Update documentation and procedures

**Annually:**

- Comprehensive PBMM assessment
- Security control testing
- Risk assessment update
- Policy and procedure review

## A.7 Integration Testing and Validation

### A.7.1 SharePoint Integration Testing

**Test Scenarios:**

1. Verify access only to approved SharePoint sites
2. Test DLP policy enforcement with SharePoint connectors
3. Validate permissions inheritance from SharePoint
4. Confirm external sharing restrictions

### A.7.2 Teams Integration Testing

**Test Scenarios:**

1. Verify app installation restrictions
2. Test guest access blocking
3. Validate sharing limitations
4. Confirm admin approval workflow

### A.7.3 Power Pages Security Testing

**Test Scenarios:**

1. Authentication bypass attempts
2. Authorization escalation testing
3. Input validation and XSS testing
4. CSRF protection verification
5. SQL injection testing
6. Session management testing

## A.8 Implementation Checklist

### A.8.1 Pre-Implementation Requirements

- [ ] Tenant admin access to Power Platform Admin Center
- [ ] PowerShell modules installed and configured
- [ ] Security groups created in Microsoft Entra ID
- [ ] Environment strategy documented and approved
- [ ] DLP policy requirements defined
- [ ] Backup and rollback procedures prepared

### A.8.2 Phase 1: Core Tenant Configuration (Days 1-7)

- [ ] Configure core tenant security settings (A.1.1)
- [ ] Disable search and discovery features (A.1.2)
- [ ] Configure Power Apps specific settings (A.1.3)
- [ ] Set Teams integration limits (A.1.4)
- [ ] Disable Copilot features (A.1.5)
- [ ] Configure environment routing (A.1.6)

### A.8.3 Phase 2: Environment Groups and DLP (Days 8-14)

- [ ] Create environment groups (A.2.1)
- [ ] Configure environment group rules (A.2.2)
- [ ] Implement tenant-wide DLP policy (A.5.1)
- [ ] Create production DLP policy (A.5.2)
- [ ] Configure connector action controls (A.5.3)

### A.8.4 Phase 3: Integration Security (Days 15-21)

- [ ] Configure SharePoint integration (A.3.1)
- [ ] Set OneDrive restrictions (A.3.2)
- [ ] Configure Teams integration (A.3.3)
- [ ] Implement Copilot controls (A.3.4)

### A.8.5 Phase 4: Power Pages Security (Days 22-30)

- [ ] Configure Power Pages tenant settings (A.4.1)
- [ ] Set up authentication providers (A.4.2.1)
- [ ] Configure authorization controls (A.4.2.2)
- [ ] Implement network security (A.4.2.3)
- [ ] Configure CSP headers (A.4.2.4)
- [ ] Enable transport security (A.4.2.5)
- [ ] Set up monitoring and auditing (A.4.2.7)

### A.8.6 Phase 5: Monitoring and Compliance (Days 31-60)

- [ ] Deploy automated compliance checking (A.6.1)
- [ ] Establish assessment schedule (A.6.2)
- [ ] Conduct integration testing (A.7)
- [ ] Train administrative staff
- [ ] Document procedures and runbooks
- [ ] Conduct first quarterly review

## A.9 Troubleshooting Guide

### A.9.1 Common Configuration Issues

**Issue:** Environment creation still allowed for non-admins
**Solution:** Verify `disableEnvironmentCreationByNonAdminUsers` is set to `true` and changes have been saved

**Issue:** DLP policy not enforcing connector restrictions
**Solution:** Check policy scope and ensure it applies to the correct environments; verify policy is published

**Issue:** Power Pages site accessible without authentication
**Solution:** Verify site visibility is set to "Private" and authentication provider is configured

**Issue:** SharePoint connector still allowing external sharing
**Solution:** Check connector action-level controls and ensure SharePoint external sharing is disabled

### A.9.2 Rollback Procedures

**Emergency Rollback Steps:**

1. Document current issue and impact
2. Identify specific configuration to rollback
3. Use PowerShell to revert tenant settings
4. Test functionality after rollback
5. Notify stakeholders of temporary configuration change
6. Plan remediation approach

**Rollback PowerShell Example:**

```powershell
# Rollback example - re-enable environment creation temporarily
$settings = @{
    disableEnvironmentCreationByNonAdminUsers = $false
}
Set-TenantSettings -RequestBody $settings
```

---

## Document Control

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | July 2025 | SSC/TBS Working Group | Initial version with complete Annex A |

**Review Schedule:** Quarterly or as required by regulatory changes  
**Next Review Date:** October 2025  
**Approval Authority:** Chief Information Officer

**Document Classification:** Protected B  
**Authority:** Shared Services Canada (SSC) & Treasury Board Secretariat (TBS)  
**Compliance Framework:** ITSG-33 / CCCS Medium / PBMM  
**Last Updated:** July 2025  
**Version:** 1.0  
**Next Review:** October 2025

**For Technical Support:** Contact your departmental Power Platform Administrator  
**For Policy Questions:** Contact SSC Cloud Security Team  
**Emergency Escalation:** Chief Information Security Officer (CISO)